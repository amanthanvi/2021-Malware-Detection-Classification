# -*- coding: utf-8 -*-
"""feature_vectorization_test

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1kmX9t1RDZTSVgpdnUzhLTeXAl_qpQ_7a
"""

from src.feature_vectorization import FeatureVectorization
import tarfile
import pytest

def data_download_and_feature_vectorization():
  od.download("https://ember.elastic.co/ember_dataset_2018_2.tar.bz2")
  tar = tarfile.open("./ember_dataset_2018_2.tar.bz2", "r:bz2")  
  tar.extractall() #unzips and decompresses dataset
  tar.close()
  data_dir = "./ember2018/"
  FeatureVectorization.create_vectorized_features(data_dir)
  X_train, y_train, X_test, y_test = FeatureVectorization.read_vectorized_features(data_dir)
  a = len(X_train)
  assert(a == 800000)